# -*- coding: utf-8 -*-
"""1D PRW trajectories.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Ex6XcpBOfe9uqbKkrGxxb9i6WOSpz8WG
"""

import numpy as np
import random
import matplotlib.pyplot as plt


N = 5     #Number of walkers
L = 100    #Total space
T = 50    #time steps
x_0 = L/2   #Initial position
dx = 1
p_1 = .98

Xmatrix = np.zeros((T, N))
Vmatrix = np.zeros((T, N))


def v_initial():
  r = random.random()
  if r < 0.5:
    v = 1
  else:
    v = -1
  return v

def v_t(prev_v):
  r = random.random()
  if r < p_1:
    v = prev_v
  else:
    v = -prev_v
  return v



def x_pos():
    for n in range(N):
        x = x_0
        Xmatrix[0, n] = x
        Vmatrix[0, n] = v_initial()
        for t in range(1, T):



            Vmatrix[t, n] = v_t(Vmatrix[t-1, n])
            step = dx * Vmatrix[t, n]

            x = x + step



            if x >= L:  # periodic boundary conditions
                x -= L
            elif x < 0:
                x += L
            Xmatrix[t, n] = x
    return Xmatrix


Xmatrix = x_pos() # call function/fill matrix

fig, (plot1, plot2) = plt.subplots(1, 2, figsize=(15, 4)) # subplots

#trajectory plots
for n in range(N):
    plot1.plot(Xmatrix[range(T), n])
plot1.set_xlabel("Time (t)")
plot1.set_ylabel("Position (x)")


#Histogram
t = 49
pos_t = Xmatrix[t,:]
norm_pos_t = (Xmatrix[t,:])/L

plot2.hist(pos_t, bins=L,  range=(0, L), edgecolor='black', density = True)




fig, (plot3, plot4) = plt.subplots(1, 2, figsize=(15, 4)) # 2nd set of subplots
# mean
mean = np.mean(Xmatrix, axis=1)

plot3.plot(range(T), mean, color='black', linewidth=2)
plot3.set_xlabel("Time (t)")
plot3.set_ylabel("Mean")

# 2nd moment
scnd_moment = np.mean(Xmatrix**2, axis = 1)
plt.figure()
plt.xlabel("Time (t))")
plt.ylabel("2nd moment")
plt.plot(range(T), scnd_moment, color='black', linewidth=2)
#variance

#var = np.var(Xmatrix, axis=1)
var = scnd_moment - mean**2
plot4.plot(range(T), var, color='black', linewidth=2)
plot4.set_xlabel("Time (t)")
plot4.set_ylabel("Variance")

#theoretical variance
Tvar = []

for i in range(1,T):
  T = dx**2 * i
  Tvar.append(T)
  i += 1

plot4.plot(range(T), Tvar, color='red', linewidth=2)



plt.show()